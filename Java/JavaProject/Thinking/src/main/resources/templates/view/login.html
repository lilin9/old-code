<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="el">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script src="/js/jquery-3.6.3.min.js"></script>
    <script src="/js/popper.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/main.css" rel="stylesheet"/>
    <style>
        /*.divStyle{*/
        /*    width: 365px;*/
        /*    width: 500px;*/
        /*    margin: 0 auto;*/
        /*    margin-top: 200px;*/
        /*}*/

        /*.btm{*/
        /*    width: 168px;*/
        /*}*/
        /*#btmStyle{*/
        /*    margin-top: 36px;*/
        /*    text-align: right;*/
        /*}*/

        /*a{*/
        /* text-decoration: none;*/
        /*}*/

        /*label{*/
        /*    margin: 10px 0px;*/
        /*}*/
    </style>
</head>
<body>

<div class="divStyle">
    <form id="loginForm">
        <div class="form-group">
            <label for="humanName">用户名</label>
            <input type="text" name="humanName" class="form-control" id="humanName">
        </div>
        <div class="form-group">
            <label for="humanPassword">密码</label>
            <input type="password" name="humanPassword" class="form-control" id="humanPassword">
        </div>

        <div class="btmStyle">
            <button type="button" class="btn btn-primary btm" id="loginBtn">登录</button>
            <a th:href="@{/to/register}">注册</a>
        </div>

    </form>
</div>

<script type="module">
    import utils from '/js/utils.js';
    //点击登录时
    $("#loginBtn").click(function () {
        //获取登录表单数据,并转成 json 数据
        let userData = utils.getObjectJson($("#loginForm").serializeArray());
        //异步提交表单数据
        $.ajax({
            type: "POST",
            url: "/login",
            async: false,
            data: userData,
            dataType: "json",
            headers: {'Content-Type': 'application/json'},
            success: function (data) {
                console.log(data);
                //是不是登录成功
                if (data.code == "200") {
                    //将用户信息存入session
                    sessionStorage.setItem("human", JSON.stringify(data.data));
                    //去首页
                    window.location.href = "../index.html";
                } else {
                    alert(data.message + ", 请重新登录");
                }
            }
        });
    });
</script>
</body>
</html>