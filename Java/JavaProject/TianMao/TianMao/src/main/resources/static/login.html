<!DOCTYPE html>
<html lang="en">
<head lang="en">
    <meta charset="UTF-8">
    <title>用户登录</title>
    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/login.css"/>
</head>
<body>
<div id="main">
    <div id="header">
    </div>
    <div class="container">
        <div class="bgPic"><img src="images/loginAndRegister/loginRegister.jpg" alt=""/></div>
        <div class="register">
            <div class="title">
                <span>登录</span>
                <a href="register.html">去注册</a>
            </div>
            <form id="form-login">
                <div class="default">
                    <p>请输入用户名或手机号码</p>
                    <input id="username" name="username" data-form="username" type="text" placeholder="会员名/邮箱/手机号"/>
                    <label for="username"></label>
                </div>
                <div class="default">
                    <p>请输入账号密码</p>
                    <input id="password" name="password" data-form="password" type="password" placeholder="密码"/>
                    <label for="password"></label>
                </div>
                <div class="submit">
                        <span class="notice">
                            <a href="recallPassword.html">忘记密码</a>
                        </span>
<!--                    <button class="s_hover" data-form="submit">登录</button>-->
                    <input class="s_hover" type="button" value="登录" style="font-size:16px;color:#fff;">
                </div>
            </form>
        </div>
    </div>
    <div id="footer">
    </div>
</div>

<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/jquery.cookie.js"></script>
<script type="text/javascript">
    $(".s_hover").click(function () {
        console.log("点击函数被调用")
        $.ajax({
            url: "/users/login",
            type: "post",
            data: $("#form-login").serialize(),
            dataType: "json",
            success: function (json) {
                if (json.state === 200) {
                    //将用户头像保存到 cookie 中
                    //expires：设置有效值7天
                    //path：设置cookie的有效路径 --> 目前为网站根路径
                    $.cookie("avatar", json.data.avatar, {expires: 7, path: "/"});
                    location.href = "index.html";
                } else if (json.state === 4001) {
                    alert("用户不存在");
                } else if ((json.state === 4002)) {
                    alert("密码错误");
                }
            },
            error: function (xhr) {
                alert("登录时产生未知错误" + "\n" + xhr.status)
            }
        });
    });
</script>
</body>
</html>